(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[317],{19686:(e,t,s)=>{Promise.resolve().then(s.bind(s,56437))},56437:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var a=s(36362),i=s(39938),l=s(11249),n=s(35865),r=s(60833),o=s(94040),c=s(50977),d=s(31423),m=s(4480),h=s(34250),x=s(18409),u=s(16033);function g(){let{data:e,status:t}=(0,l.useSession)(),s=(0,n.useRouter)(),[o,c]=(0,i.useState)([]),[d,m]=(0,i.useState)(!0),[h,x]=(0,i.useState)("all");(0,i.useEffect)(()=>{"unauthenticated"===t?s.push("/"):"authenticated"===t&&e&&((0,r.O5)(e.accessToken),u())},[t,e,s]);let u=async()=>{try{let e=await r.Ay.get("/notifications").catch(()=>({data:[{id:"1",type:"battle",title:"New Battle Detected",message:"A large-scale battle has started in M-OEE8 system",timestamp:new Date(Date.now()-3e5).toISOString(),read:!1,severity:"info"},{id:"2",type:"alert",title:"High ISK Loss",message:"A Titan was destroyed in 1DQ1-A, total loss: 85B ISK",timestamp:new Date(Date.now()-6e5).toISOString(),read:!1,severity:"warning"},{id:"3",type:"ingestion",title:"Ingestion Job Completed",message:"Killmail ingestion job has successfully processed 5,000 records",timestamp:new Date(Date.now()-18e5).toISOString(),read:!0,severity:"success"},{id:"4",type:"battle",title:"Battle Ended",message:"Battle in T5ZI-S has ended. Duration: 2.5 hours, Kills: 234",timestamp:new Date(Date.now()-36e5).toISOString(),read:!0,severity:"info"},{id:"5",type:"alert",title:"Service Alert",message:"Enrichment service experienced a temporary slowdown",timestamp:new Date(Date.now()-72e5).toISOString(),read:!0,severity:"error"}]}));c(e.data||[])}catch(e){console.error("Failed to fetch notifications:",e)}finally{m(!1)}},g=async e=>{try{await r.Ay.post("/notifications/".concat(e,"/read")),c(t=>t.map(t=>t.id===e?{...t,read:!0}:t))}catch(e){console.error("Failed to mark as read:",e)}},f=async()=>{try{await r.Ay.post("/notifications/read-all"),c(e=>e.map(e=>({...e,read:!0})))}catch(e){console.error("Failed to mark all as read:",e)}},p=async e=>{try{await r.Ay.delete("/notifications/".concat(e)),c(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Failed to delete notification:",e)}},y=o.filter(e=>"all"===h||!e.read),w=o.filter(e=>!e.read).length;return d?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"text-slate-400",children:"Loading notifications..."})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Notifications"}),(0,a.jsx)("p",{className:"text-slate-400",children:"Stay updated with battles, ingestion jobs, and system alerts"})]}),w>0&&(0,a.jsx)("button",{onClick:f,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium",children:"Mark All as Read"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>x("all"),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat("all"===h?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"),children:["All (",o.length,")"]}),(0,a.jsxs)("button",{onClick:()=>x("unread"),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat("unread"===h?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"),children:["Unread (",w,")"]})]}),(0,a.jsx)("div",{className:"bg-slate-800 rounded-lg border border-slate-700 overflow-hidden",children:y.length>0?(0,a.jsx)("div",{className:"divide-y divide-slate-700",children:y.map(e=>(0,a.jsx)(b,{notification:e,onMarkAsRead:()=>g(e.id),onDelete:()=>p(e.id)},e.id))}):(0,a.jsx)("div",{className:"p-8 text-center text-slate-400",children:"unread"===h?"No unread notifications":"No notifications"})})]})}function b(e){let{notification:t,onMarkAsRead:s,onDelete:i}=e,l={battle:o.A,ingestion:c.A,alert:d.A,info:m.A}[t.type];return(0,a.jsx)("div",{className:"p-5 hover:bg-slate-700/50 transition-colors ".concat(t.read?"":"bg-blue-500/5"),children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg ".concat({info:"bg-blue-500/20 text-blue-400",warning:"bg-yellow-500/20 text-yellow-400",error:"bg-red-500/20 text-red-400",success:"bg-green-500/20 text-green-400"}[t.severity]),children:(0,a.jsx)(l,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-1",children:[(0,a.jsx)("h3",{className:"text-white font-semibold",children:t.title}),!t.read&&(0,a.jsx)("span",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-2"})]}),(0,a.jsx)("p",{className:"text-slate-400 text-sm mb-2",children:t.message}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("span",{className:"text-xs text-slate-500",children:(0,u.m)(new Date(t.timestamp),{addSuffix:!0})}),!t.read&&(0,a.jsxs)("button",{onClick:s,className:"text-xs text-blue-400 hover:text-blue-300 transition-colors flex items-center gap-1",children:[(0,a.jsx)(h.A,{className:"w-3 h-3"}),"Mark as read"]}),(0,a.jsxs)("button",{onClick:i,className:"text-xs text-red-400 hover:text-red-300 transition-colors flex items-center gap-1",children:[(0,a.jsx)(x.A,{className:"w-3 h-3"}),"Delete"]})]})]})]})})}},60833:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>l,O5:()=>i});let a=s(53396).A.create({baseURL:"http://localhost:30006",headers:{"Content-Type":"application/json"}}),i=e=>{e?a.defaults.headers.common.Authorization="Bearer ".concat(e):delete a.defaults.headers.common.Authorization},l=a}},e=>{e.O(0,[249,139,255,991,678,358],()=>e(e.s=19686)),_N_E=e.O()}]);